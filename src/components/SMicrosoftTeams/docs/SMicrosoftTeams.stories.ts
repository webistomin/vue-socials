import { Story } from '@storybook/vue3';
import { action } from '@storybook/addon-actions';
import { DEFAULT_WINDOW_FEATURES, TBaseSocialPropsOptions } from '@/mixins/BaseSocial/BaseSocial';
import SMicrosoftTeams, { ISMicrosoftTeamsShareOptions } from '../SMicrosoftTeams';
import SMicrosoftTeamsMDX from './SMisrosoftTeams.mdx';

export default {
  title: 'Share/SMicrosoftTeams',
  component: SMicrosoftTeams,
  parameters: {
    docs: {
      page: SMicrosoftTeamsMDX,
    },
  },
};

const Template: Story<TBaseSocialPropsOptions<ISMicrosoftTeamsShareOptions>> = (args) => ({
  components: { SMicrosoftTeams },

  setup() {
    const onClose = action('emit close');
    const onOpen = action('emit open');
    const onBlock = action('emit block');
    const onFocus = action('emit focus');

    return {
      args,
      onClose,
      onOpen,
      onBlock,
      onFocus,
    };
  },

  template: `
    <s-microsoft-teams
      class="base-social"
      v-bind="args"
      @popup-close="onClose"
      @popup-open="onOpen"
      @popup-block="onBlock"
      @popup-focus="onFocus"
    >
      <svg xmlns="http://www.w3.org/2000/svg" width="48" height="24" viewBox="0 0 1280 640" aria-hidden="true" focusable="false">
        <path d="M0 248v65h130V183H0v65zM143.7 183.7c-.4.3-.7 29.6-.7 65V313h130V183h-64.3c-35.4 0-64.7.3-65 .7zM1187 227c-10.5 2.3-21.6 10.1-26.3 18.7-4.1 7.6-5.7 15.4-5.7 27.5v10.7l-9.7.3-9.8.3-.3 11.2-.3 11.3h20.1v95h28v-95h41v30.2c.1 36.1.8 42.9 5.2 51.8 3.7 7.2 9.5 12 17.1 14.1 6.4 1.7 20.3 1.4 27.5-.6l6.2-1.8v-22.4l-5.7 1.9c-9.2 3.1-16.4 1.2-20-5.5-1.6-2.8-1.8-6.9-2.1-35.5l-.3-32.2h28.1v-23h-28v-34.2l-2.7.7c-1.6.3-7.9 2.2-14 4.1l-11.3 3.5v26.4l-20.6-.3-20.6-.3.3-11.7c.4-12.8 1.7-16.5 7.1-20.5 3.7-2.7 12.3-3.4 18.2-1.4l4.6 1.6V240c0-10.1-.2-11.9-1.7-12.4-3-1.2-19.7-1.5-24.3-.6zM564.4 236.9c-5.2 3.2-7.7 7.6-7.7 13.7 0 9.8 7.4 16.1 18.1 15.2 9.1-.8 14.7-6.6 14.7-15.3 0-6-2-9.5-7.5-13.3-4.3-2.9-13.1-3.1-17.6-.3zM355 320v82h27l-.2-63c-.2-34.7 0-63 .3-63s11.9 28.4 25.9 63l25.4 63.1 10-.3 10-.3 24.7-62.3c13.6-34.3 25-62.6 25.3-62.9.3-.4.6 27.8.6 62.5V402h28V238h-38.6l-22.9 56.2c-12.6 31-23.8 58.3-24.8 60.7l-2 4.5-8.7-22c-4.8-12-15.6-39.3-24-60.7L395.7 238H355v82zM652 283.5c-20.3 4.6-36.2 19.1-43 39.5-3.1 9-3.9 28.7-1.6 38.4 3.6 15.1 14.5 29.7 27.1 36.3 15.6 8.1 38.9 8.9 56.2 2.1l5.8-2.3.5-12.8c.3-7 .4-12.7.3-12.7-.1 0-3.1 1.6-6.7 3.5-16.7 9.3-35.4 7.7-46.3-3.8-8.2-8.6-11.4-21-9.3-35.6 2-13.9 10-24.7 21.6-29 10.9-4.1 26.4-2.2 36.4 4.6 1.9 1.2 3.7 2.3 4 2.3.3 0 .4-6 .2-13.4l-.3-13.4-6.7-2.2c-8.7-2.9-28.4-3.7-38.2-1.5zM771 283.1c-9.8 1.4-17.5 7.1-22.4 16.6l-2.5 4.8-.1-10.3v-10.3l-13.7.3-13.8.3-.3 58.7-.2 58.8h27.9l.3-36.3.3-36.2 2.8-6c4.4-9.3 9.5-14 17.1-15.4 5.1-.9 13.4.2 17.8 2.5l2.8 1.5v-13.5c0-9.7-.4-13.7-1.2-14.3-2.1-1.2-10-1.9-14.8-1.2zM833.1 283.5c-21.7 4.9-37.1 20.1-42.6 42-2.3 9.1-2.4 27.4-.1 36.9 4.7 19.9 19.7 35 39.8 40.3 8.6 2.2 26.1 2.2 35.3-.2 17.9-4.5 32.4-17.1 38.6-33.3 3.6-9.9 5.2-20.6 4.5-31.7-1-18.1-5.8-29.8-16-40.1-6.4-6.3-11-9.2-20.6-12.6-7.4-2.7-29.6-3.4-38.9-1.3zm29.4 23.9c6.7 3 12.7 10 15.1 17.3 1.5 4.6 1.9 8.7 1.9 19.3-.1 11.7-.4 14.3-2.4 19.3-2.9 7.4-7.1 12.1-13.5 15.4-4.4 2.3-6.4 2.6-14.1 2.6-9.9 0-15.3-1.7-21.3-6.7-9.4-8.1-13.7-27.4-9.7-44.4 2.8-11.6 8-18.6 17-22.8 7.1-3.4 19.9-3.4 27 0zM951.3 283.5c-11.8 3.3-22.3 11.6-26.4 20.8-3.3 7.5-3.3 21.1.1 28.2 4.1 8.4 8.7 12 26.4 20.5 8.9 4.3 17 8.8 18 9.9 2.6 2.9 3.3 10.4 1.2 13.6-5.7 8.7-26.9 7.8-42.8-1.9l-5.8-3.5V398l3.6 1.5c11.1 4.6 32.5 6.1 44.2 3.1 12.9-3.3 22.4-10.3 27.2-20.1 2-4.2 2.4-6.5 2.4-14.5 0-7.8-.3-10.2-2.1-13.6-5-9.5-11.4-14.3-29.4-22.4-13.2-5.8-16.8-8.9-17.6-14.9-1.9-13.7 18.8-17.7 39-7.5l4.8 2.5-.3-12.8-.3-12.7-6-1.9c-8.2-2.6-28.9-3.3-36.2-1.2zM1055.5 283.9c-14.1 3.5-26.4 12-33.6 23.2-10.4 16.3-12.7 42.9-5.4 62.6 9 24.1 34.5 37.9 63.4 34.3 16.5-2 25.5-6.1 35.6-16.4 12.2-12.3 16.9-25 16.9-45.6 0-20.1-4.7-33.3-15.7-44.4-7.4-7.3-13.8-10.9-24.3-13.6-9.9-2.6-26.9-2.6-36.9-.1zm32.1 23.8c5.6 3 10.8 9 13.5 15.9 1.9 5 2.3 7.8 2.3 18.9.1 20.5-4.1 30.1-15.8 36-5.3 2.6-7 2.9-14.5 2.9-10.8-.1-17.5-2.7-23.1-9.1-6.5-7.5-8.4-13.7-8.5-28.3 0-20 4.5-29.8 16.7-36 6-3 6.7-3.1 15.8-2.8 7.2.3 10.5.9 13.6 2.5zM559 343v59h28l-.2-58.8-.3-58.7-13.7-.3-13.8-.3V343zM0 392v65h130V327H0v65zM143.2 391.7l.3 64.8 64.8.3 64.7.2V327H143l.2 64.7z"/>
      </svg>
    </s-microsoft-teams>
`,
});

export const Default = Template.bind({});
Default.args = {
  windowFeatures: DEFAULT_WINDOW_FEATURES,
  shareOptions: {
    url: 'https://github.com/',
    preview: true,
    text: 'Text',
    title: 'Title',
    instruction: 'Instruction',
  },
  useNativeBehavior: false,
};
